---
layout: post
title:  "Advection over steep slopes"
date:   2016-10-03 15:45:00
---
<p>There are many ways to represent terrain in atmospheric models.  Terrain following coordinates are in widespread operational use but can suffer from numerical errors near steep slopes.  Advection errors, and errors calculating pressure gradients both reduce model accuracy.  The cut cell method is often put forward as an alternative which can reduce pressure gradient errors, but the technique may still suffer from advection errors where flow is misaligned with the mesh.  Without special treatment, the cut cell method can create very small cells which constrain the timestep when explicit methods are used.</p>

<p>We present a new type of mesh, the slanted cell mesh, which avoids additional timestep constraints by creating cells that are long in the direction of flow.  We describe a multidimensional, finite volume advection scheme that is suitable for arbitrary meshes.  We discuss a new mathematical technique, the adaptive polynomial fit, which improves advection accuracy at the lower boundary around steep terrain.</p>

<figure>
  <img src="/images/slugSlantedCells.png"/>
  <caption>Comparison of linearUpwind and cubicFit error fields in the &ldquo;slug&rdquo; advection test.</caption>
</figure>

<p>Results of the slanted cell mesh and multidimensional advection scheme are compared with terrain following and cut cell meshes in a newly formulated test case which advects a stably stratified thermal profile in a prescribed, terrain-following wind.  The test is designed to mimic thermal flow in the atmosphere and challenges the advection scheme at the lower boundary.  We show that the scheme is resilient to grid distortions and misalignment of the flow with the grid.  Incorporating the advection scheme into a dynamical core, we compare results with terrain following and cut cell meshes, and demonstrate that the slanted cell mesh also reduces pressure gradient errors.</p>

<ul>
  <li><a href="/ecmwfnumerics2016/advection-over-steep-slopes.pptx">PowerPoint slides</a></li>
  <li><a href="/ecmwfnumerics2016/cubicfit.pdf">A complete description of the cubicFit advection scheme</a></li>
  <li>An <a href="http://www.openfoam.org">OpenFOAM</a> implementation of cubicFit is <a href="https://github.com/AtmosFOAM/AtmosFOAM">available on GitHub</a></li>
  <li>The slanted cell method is described in the open access article <em><a href="http://dx.doi.org/10.1175/MWR-D-15-0226.1">Comparison of Terrain-Following and Cut-Cell Grids Using a Nonhydrostatic Model</a></em></li>
</ul>

<p><em>Presented at the <a href="http://www.ecmwf.int/en/learning/workshops-and-seminars/workshop-numerical-and-computational-methods-simulation-all-scale-geophysical-flows">ECMWF workshop on numerical and computational methods for simulation of all-scale geophysical flows</a>.</em></p>
